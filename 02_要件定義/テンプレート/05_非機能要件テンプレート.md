# 非機能要件定義書

## ドキュメント管理情報

| 項目 | 内容 |
|------|------|
| プロジェクト名 | |
| ドキュメント名 | 非機能要件定義書 |
| 作成日 | YYYY/MM/DD |
| 最終更新日 | YYYY/MM/DD |
| 版数 | v1.0 |
| 作成者 | |
| 承認者 | |

---

## 1. 非機能要件概要

### 1.1 本書の目的

システムの品質特性に関する要件を定義する

### 1.2 適用範囲

本システムの全機能に適用

### 1.3 優先順位の定義

| 優先度 | 定義 |
|--------|------|
| 必須 | システム稼働に不可欠な要件 |
| 推奨 | 実装が望ましい要件 |
| 任意 | 次期フェーズで検討する要件 |

---

## 2. 性能要件

### 2.1 レスポンスタイム

#### 2.1.1 オンライン処理

| 処理種別 | 画面/機能 | 目標値 | 上限値 | 測定条件 | 優先度 |
|---------|----------|--------|--------|---------|--------|
| 画面表示 | 全画面 | 2秒以内 | 3秒以内 | 通常負荷時 | 必須 |
| 検索処理 | SC-010: 一覧画面 | 3秒以内 | 5秒以内 | 検索条件指定時、10,000件以下 | 必須 |
| 登録処理 | SC-012: 登録画面 | 2秒以内 | 3秒以内 | 通常負荷時 | 必須 |
| 更新処理 | SC-013: 更新画面 | 2秒以内 | 3秒以内 | 通常負荷時 | 必須 |
| 削除処理 | 各画面 | 2秒以内 | 3秒以内 | 通常負荷時 | 必須 |
| 帳票出力 | RP-001 | 5秒以内 | 10秒以内 | 100ページ以下 | 必須 |
| ファイルダウンロード | 各画面 | 3秒以内 | 5秒以内 | 10MB以下 | 推奨 |
| API応答 | 全API | 1秒以内 | 2秒以内 | 通常負荷時 | 必須 |

**測定方法:**
- クライアント側: 操作開始から画面表示完了まで
- サーバー側: リクエスト受信からレスポンス送信まで

**測定環境:**
- ネットワーク: 社内LAN（1Gbps）
- ブラウザ: Chrome最新版
- 同時アクセス数: XX名

#### 2.1.2 バッチ処理

| バッチID | バッチ名 | 処理件数（想定） | 目標時間 | 完了時刻 | 優先度 |
|---------|---------|----------------|---------|---------|--------|
| BT-001 | 日次集計バッチ | 100,000件 | 30分以内 | 06:00まで | 必須 |
| BT-002 | データ連携バッチ | 50,000件 | 15分以内 | 23:00まで | 必須 |
| BT-003 | 月次レポート生成 | 500,000件 | 2時間以内 | 04:00まで | 必須 |

**測定条件:**
- 他バッチとの並行実行なし
- DB負荷: 通常時

### 2.2 スループット

| 項目 | 目標値 | 上限値 | 測定条件 | 優先度 |
|------|--------|--------|---------|--------|
| 同時ログインユーザー数 | 100ユーザー | 150ユーザー | ピーク時 | 必須 |
| 同時実行トランザクション数 | 50 TPS | 100 TPS | ピーク時 | 必須 |
| API同時リクエスト数 | 100 req/sec | 150 req/sec | ピーク時 | 必須 |
| ファイルアップロード同時数 | 10ファイル | 20ファイル | - | 推奨 |

**ピーク時の定義:**
- 平日 9:00～10:00、13:00～14:00

### 2.3 処理容量

| 項目 | 初期値 | 3年後想定 | 5年後想定 | 備考 |
|------|--------|----------|----------|------|
| 登録ユーザー数 | 500名 | 1,000名 | 1,500名 | |
| マスタデータ件数 | 10,000件 | 20,000件 | 30,000件 | |
| トランザクションデータ件数 | 100,000件/年 | 300,000件/年 | 500,000件/年 | |
| ファイル保存容量 | 100GB | 500GB | 1TB | |
| DBサイズ | 50GB | 200GB | 500GB | |
| ログ保存容量 | 10GB/月 | 20GB/月 | 30GB/月 | |

### 2.4 リソース使用率

| リソース | 通常時 | ピーク時 | 上限 | 優先度 |
|---------|-------|---------|------|--------|
| CPU使用率 | 50%以下 | 70%以下 | 80% | 必須 |
| メモリ使用率 | 60%以下 | 80%以下 | 90% | 必須 |
| ディスク使用率 | 70%以下 | 80%以下 | 85% | 必須 |
| ネットワーク帯域使用率 | 40%以下 | 60%以下 | 70% | 推奨 |

---

## 3. 可用性要件

### 3.1 稼働率

| 項目 | 目標値 | 測定期間 | 優先度 |
|------|--------|---------|--------|
| システム稼働率 | 99.5%以上 | 月次 | 必須 |
| 年間停止時間 | 43時間以内 | 年間 | 必須 |

**計算式:**
```
稼働率 = (総時間 - 停止時間) / 総時間 × 100
```

**除外事項:**
- 計画停止（定期メンテナンス）
- 外部システム起因の停止

### 3.2 稼働時間

| 項目 | 内容 | 優先度 |
|------|------|--------|
| サービス提供時間 | 平日 8:00～20:00<br>土日祝: サービス停止 | 必須 |
| バッチ処理時間 | 平日 0:00～6:00 | 必須 |
| メンテナンス時間 | 第2日曜日 9:00～12:00（月1回） | 必須 |

### 3.3 計画停止

| 停止種別 | 頻度 | 許容停止時間 | 通知期限 | 優先度 |
|---------|------|------------|---------|--------|
| 定期メンテナンス | 月1回 | 3時間以内 | 1週間前 | 必須 |
| 緊急メンテナンス | 必要時 | 1時間以内 | 前日まで | 必須 |
| システム更新 | 四半期ごと | 4時間以内 | 2週間前 | 必須 |

### 3.4 障害復旧

| 項目 | 目標値 | 優先度 |
|------|--------|--------|
| RTO（目標復旧時間） | 4時間以内 | 必須 |
| RPO（目標復旧時点） | 24時間以内 | 必須 |
| MTTR（平均復旧時間） | 2時間以内 | 推奨 |
| MTBF（平均故障間隔） | 720時間以上（1ヶ月） | 推奨 |

---

## 4. セキュリティ要件

### 4.1 認証

| 項目 | 要件内容 | 優先度 |
|------|---------|--------|
| 認証方式 | ユーザーID・パスワード認証 | 必須 |
| 多要素認証（MFA） | 管理者アカウントに必須 | 推奨 |
| パスワードポリシー | ・8文字以上<br>・英大文字・小文字・数字・記号を含む<br>・過去3回のパスワードは使用不可<br>・90日ごとに変更 | 必須 |
| アカウントロック | ・ログイン失敗5回でロック<br>・ロック解除は管理者または30分後 | 必須 |
| セッション管理 | ・セッションタイムアウト: 30分<br>・同時ログイン制限: 1端末のみ | 必須 |
| シングルサインオン（SSO） | 社内AD連携 | 任意 |

### 4.2 認可（アクセス制御）

| 項目 | 要件内容 | 優先度 |
|------|---------|--------|
| ロールベースアクセス制御（RBAC） | ・システム管理者<br>・部門管理者<br>・一般ユーザー<br>・閲覧者 | 必須 |
| 画面・機能単位のアクセス制御 | ロール毎に画面・機能の利用可否を制御 | 必須 |
| データ単位のアクセス制御 | 所属部門のデータのみ参照・更新可能 | 必須 |
| 操作権限の分離 | 登録・更新・削除権限を個別に設定可能 | 必須 |

### 4.3 データ保護

| 項目 | 要件内容 | 優先度 |
|------|---------|--------|
| 通信の暗号化 | ・HTTPS（TLS 1.2以上）<br>・証明書: 正式なCA発行 | 必須 |
| データベース暗号化 | ・個人情報項目を暗号化<br>・AES-256を使用 | 必須 |
| パスワード暗号化 | ・ハッシュ化（bcryptまたはArgon2）<br>・ソルト付与 | 必須 |
| ファイル暗号化 | アップロードファイルを暗号化保存 | 推奨 |
| バックアップデータ暗号化 | バックアップデータを暗号化 | 必須 |

### 4.4 監査ログ

| 項目 | 要件内容 | 優先度 |
|------|---------|--------|
| 操作ログ | ・ログイン/ログアウト<br>・データ登録/更新/削除<br>・設定変更<br>・ファイルダウンロード | 必須 |
| ログ記録項目 | ・日時<br>・ユーザーID<br>・操作内容<br>・IPアドレス<br>・結果（成功/失敗） | 必須 |
| ログ保存期間 | 1年間 | 必須 |
| ログの改ざん防止 | ・ログファイルの書き込み権限制限<br>・ハッシュ値による整合性チェック | 必須 |
| ログ閲覧権限 | システム管理者のみ | 必須 |

### 4.5 脆弱性対策

| 項目 | 要件内容 | 優先度 |
|------|---------|--------|
| SQLインジェクション対策 | ・プリペアドステートメント使用<br>・入力値検証 | 必須 |
| XSS対策 | ・出力エスケープ処理<br>・Content Security Policy設定 | 必須 |
| CSRF対策 | トークンによる正当性確認 | 必須 |
| セッションハイジャック対策 | ・セッションIDの定期的な再生成<br>・Secure/HttpOnly属性の設定 | 必須 |
| ディレクトリトラバーサル対策 | ファイルパスの検証 | 必須 |
| 脆弱性診断 | ・年1回実施<br>・重大な脆弱性は即座に対応 | 必須 |

### 4.6 個人情報保護

| 項目 | 要件内容 | 優先度 |
|------|---------|--------|
| 個人情報の取り扱い | 個人情報保護法に準拠 | 必須 |
| 個人情報の項目 | ・氏名<br>・メールアドレス<br>・電話番号<br>・所属部門 | 必須 |
| マスキング表示 | 一覧画面では個人情報の一部をマスキング | 推奨 |
| データ削除 | 退職者のデータは1年後に削除 | 必須 |

---

## 5. 運用・保守要件

### 5.1 バックアップ

| 項目 | 要件内容 | 優先度 |
|------|---------|--------|
| バックアップ対象 | ・データベース（全データ）<br>・アプリケーションコード<br>・設定ファイル<br>・アップロードファイル | 必須 |
| バックアップ方式 | ・フルバックアップ: 週1回（日曜日）<br>・差分バックアップ: 日次（平日） | 必須 |
| バックアップ取得時刻 | 03:00～04:00 | 必須 |
| バックアップ保存先 | ・オンサイト: NAS<br>・オフサイト: クラウドストレージ | 必須 |
| バックアップ保存期間 | ・フルバックアップ: 4週間<br>・差分バックアップ: 1週間 | 必須 |
| バックアップ暗号化 | AES-256で暗号化 | 必須 |

### 5.2 リストア

| 項目 | 要件内容 | 優先度 |
|------|---------|--------|
| リストア手順書 | 詳細な手順書を作成・維持 | 必須 |
| リストアテスト | 四半期に1回実施 | 必須 |
| リストア時間 | 2時間以内 | 必須 |
| リストア範囲 | ・全体リストア<br>・部分リストア（テーブル単位） | 必須 |

### 5.3 監視

| 監視項目 | 監視内容 | 監視間隔 | 閾値 | 通知先 | 優先度 |
|---------|---------|---------|------|--------|--------|
| サーバー死活監視 | Ping応答 | 1分 | 応答なし3回 | 運用担当者 | 必須 |
| CPU使用率 | CPU使用率 | 5分 | 80%以上 | 運用担当者 | 必須 |
| メモリ使用率 | メモリ使用率 | 5分 | 90%以上 | 運用担当者 | 必須 |
| ディスク使用率 | ディスク使用率 | 30分 | 85%以上 | 運用担当者 | 必須 |
| プロセス監視 | アプリケーションプロセス | 5分 | プロセス停止 | 運用担当者 | 必須 |
| DB接続監視 | DB接続状態 | 5分 | 接続失敗 | 運用担当者・DBA | 必須 |
| バッチ監視 | バッチ実行状況 | 実行時 | 異常終了 | 運用担当者 | 必須 |
| エラーログ監視 | エラーログ出力 | リアルタイム | ERRORレベル | 運用担当者 | 必須 |
| レスポンス監視 | 画面応答時間 | 5分 | 5秒以上 | 運用担当者 | 推奨 |
| SSL証明書監視 | 証明書有効期限 | 日次 | 残30日 | 運用担当者 | 必須 |

### 5.4 ログ管理

| ログ種別 | 出力内容 | 保存期間 | ローテーション | 優先度 |
|---------|---------|---------|--------------|--------|
| アプリケーションログ | ・INFO/WARN/ERROR<br>・処理開始/終了<br>・エラー詳細 | 3ヶ月 | 日次 | 必須 |
| アクセスログ | ・日時<br>・URL<br>・IPアドレス<br>・ユーザーエージェント | 1年 | 週次 | 必須 |
| 監査ログ | 「4.4 監査ログ」参照 | 1年 | 月次 | 必須 |
| DBログ | ・スロークエリ<br>・エラーログ | 1ヶ月 | 週次 | 推奨 |
| バッチ実行ログ | ・開始/終了時刻<br>・処理件数<br>・エラー内容 | 6ヶ月 | 月次 | 必須 |

### 5.5 障害対応

| 項目 | 要件内容 | 優先度 |
|------|---------|--------|
| 障害検知 | 監視システムによる自動検知 | 必須 |
| 第一報 | 障害検知から15分以内に関係者に通知 | 必須 |
| 一次対応 | 障害検知から30分以内に一次対応開始 | 必須 |
| 復旧完了報告 | 復旧完了後1時間以内に報告 | 必須 |
| 障害報告書 | 復旧後3営業日以内に提出 | 必須 |
| エスカレーション | 2時間経過しても復旧見込みがない場合 | 必須 |

### 5.6 問い合わせ対応

| 項目 | 要件内容 | 優先度 |
|------|---------|--------|
| 問い合わせ窓口 | ・メール<br>・電話<br>・チャット（社内のみ） | 必須 |
| 受付時間 | 平日 9:00～18:00 | 必須 |
| 第一報 | 受付から2時間以内 | 必須 |
| 回答期限 | ・緊急: 当日中<br>・重要: 3営業日以内<br>・通常: 5営業日以内 | 必須 |
| FAQ | よくある質問をFAQサイトに掲載 | 推奨 |

---

## 6. 保守性要件

### 6.1 保守作業

| 項目 | 要件内容 | 優先度 |
|------|---------|--------|
| データメンテナンス | マスタデータの定期的な見直し・更新 | 必須 |
| 不要データ削除 | ・古いログの削除<br>・退職者データの削除 | 必須 |
| インデックス再構築 | 月次でDBインデックスを再構築 | 推奨 |
| 統計情報更新 | 週次でDB統計情報を更新 | 推奨 |

### 6.2 ドキュメント管理

| ドキュメント種別 | 更新タイミング | 管理責任者 | 優先度 |
|----------------|--------------|-----------|--------|
| システム設計書 | システム変更時 | 開発リーダー | 必須 |
| 運用手順書 | 運用変更時 | 運用リーダー | 必須 |
| 操作マニュアル | 機能追加・変更時 | PM | 必須 |
| FAQ | 問い合わせ蓄積時 | サポート担当 | 推奨 |
| 障害対応履歴 | 障害発生時 | 運用担当者 | 必須 |

### 6.3 エラー通知

| 項目 | 要件内容 | 優先度 |
|------|---------|--------|
| エラー画面表示 | ユーザーに分かりやすいエラーメッセージ表示 | 必須 |
| エラーログ出力 | ・エラーレベル（ERROR/WARN）<br>・スタックトレース<br>・発生箇所 | 必須 |
| 管理者通知 | 重大エラーは即座に管理者に通知 | 必須 |

---

## 7. 移植性・拡張性要件

### 7.1 プラットフォーム対応

| 項目 | 要件内容 | 優先度 |
|------|---------|--------|
| OS | Linux（CentOS/Ubuntu/RHEL） | 必須 |
| データベース | PostgreSQL / MySQL | 必須 |
| Webサーバー | Nginx / Apache | 必須 |
| アプリケーションサーバー | Node.js / Java（Tomcat） / Python | 必須 |

### 7.2 ブラウザ対応

| ブラウザ | バージョン | 優先度 |
|---------|-----------|--------|
| Google Chrome | 最新版、最新版-1 | 必須 |
| Mozilla Firefox | 最新版、最新版-1 | 必須 |
| Microsoft Edge | 最新版、最新版-1 | 必須 |
| Safari | 最新版 | 推奨 |

### 7.3 拡張性

| 項目 | 要件内容 | 優先度 |
|------|---------|--------|
| ユーザー数拡張 | 現在の3倍まで拡張可能な設計 | 必須 |
| データ量拡張 | 現在の5倍まで拡張可能な設計 | 必須 |
| 機能追加 | モジュール単位で機能追加が容易 | 必須 |
| 外部連携追加 | 新規外部システムとの連携が容易 | 推奨 |
| スケールアウト | サーバー台数増加による負荷分散が可能 | 推奨 |

---

## 8. ユーザビリティ要件

### 8.1 使いやすさ

| 項目 | 要件内容 | 優先度 |
|------|---------|--------|
| 操作習得時間 | 新規ユーザーが基本操作を30分以内に習得可能 | 必須 |
| 画面遷移の一貫性 | 全画面で統一されたナビゲーション | 必須 |
| エラーメッセージ | 分かりやすい日本語メッセージ、対処方法の提示 | 必須 |
| 入力支援 | ・入力候補表示<br>・カレンダーUIによる日付入力<br>・必須項目の明示 | 必須 |
| ショートカットキー | 頻繁に使う操作にショートカットキー提供 | 推奨 |

### 8.2 アクセシビリティ

| 項目 | 要件内容 | 優先度 |
|------|---------|--------|
| WCAG準拠 | WCAG 2.1 レベルAA準拠 | 推奨 |
| キーボード操作 | マウスなしで全操作が可能 | 推奨 |
| スクリーンリーダー対応 | 代替テキスト、ラベルの適切な設定 | 任意 |
| コントラスト比 | テキストと背景のコントラスト比 4.5:1以上 | 推奨 |
| フォントサイズ | 14px以上、拡大縮小可能 | 推奨 |

### 8.3 多言語対応

| 項目 | 要件内容 | 優先度 |
|------|---------|--------|
| 対応言語 | 日本語のみ | 必須 |
| 将来の多言語化 | 英語対応を考慮した設計 | 任意 |

---

## 9. 環境要件

### 9.1 サーバー環境

| 項目 | 要件 | 優先度 |
|------|------|--------|
| サーバー構成 | Webサーバー×2台（冗長化）<br>APサーバー×2台（冗長化）<br>DBサーバー×2台（Primary/Standby） | 必須 |
| ロードバランサー | L7ロードバランサー | 必須 |
| ストレージ | ・SSD推奨<br>・RAID構成（RAID10） | 必須 |

### 9.2 ネットワーク

| 項目 | 要件 | 優先度 |
|------|------|--------|
| 帯域 | 1Gbps以上 | 必須 |
| 冗長化 | ネットワーク経路の冗長化 | 推奨 |
| ファイアウォール | 必要なポートのみ開放 | 必須 |

### 9.3 クライアント環境

| 項目 | 要件 | 優先度 |
|------|------|--------|
| PC | Windows 10以降 / macOS 10.15以降 | 必須 |
| メモリ | 8GB以上 | 推奨 |
| 画面解像度 | 1366×768以上 | 必須 |
| インターネット接続 | 10Mbps以上 | 推奨 |

---

## 10. テスト要件

### 10.1 性能テスト

| テスト種別 | 実施内容 | 合格基準 | 優先度 |
|-----------|---------|---------|--------|
| 負荷テスト | 想定負荷でのレスポンス確認 | 「2.1 レスポンスタイム」の目標値を満たす | 必須 |
| ストレステスト | 上限負荷での動作確認 | システムダウンしない | 必須 |
| 耐久テスト | 長時間稼働での安定性確認 | 24時間連続稼働で異常なし | 推奨 |

### 10.2 セキュリティテスト

| テスト種別 | 実施内容 | 合格基準 | 優先度 |
|-----------|---------|---------|--------|
| 脆弱性診断 | 自動ツールによるスキャン | 重大な脆弱性ゼロ | 必須 |
| ペネトレーションテスト | 疑似攻撃による侵入テスト | 侵入不可 | 推奨 |
| 認証テスト | 不正ログイン試行 | 不正ログイン不可 | 必須 |

### 10.3 運用テスト

| テスト種別 | 実施内容 | 合格基準 | 優先度 |
|-----------|---------|---------|--------|
| バックアップ/リストアテスト | バックアップ取得とリストア実施 | リストア成功 | 必須 |
| 障害復旧テスト | 疑似障害からの復旧 | RTO/RPOを満たす | 必須 |
| 監視テスト | 監視アラート動作確認 | 閾値超過時に正しく通知 | 必須 |

---

## 11. 関連ドキュメント

| ドキュメント名 | 参照箇所 | 備考 |
|---------------|---------|------|
| 要件定義書 | 全体 | 親ドキュメント |
| プロジェクト計画書 | QCDS制約 | インプット |
| 機能一覧 | 性能要件の機能対応 | 関連資料 |

---

## 改訂履歴

| 版数 | 改訂日 | 改訂者 | 改訂内容 |
|------|--------|--------|----------|
| v0.1 | YYYY/MM/DD | | 初版作成 |
| v1.0 | YYYY/MM/DD | | 正式版 |
| | | | |
