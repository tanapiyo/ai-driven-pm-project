# 画面設計書

## 1. 画面設計方針

### UI/UXコンセプト
| 項目 | 内容 |
|------|------|
| デザインコンセプト | シンプル、直感的、モダン |
| デバイス対応 | レスポンシブ (PC/タブレット/スマートフォン) |
| UIフレームワーク | [例: Material-UI / Ant Design / shadcn/ui] |
| カラー | プライマリ: #007bff, セカンダリ: #6c757d |
| フォント | Noto Sans JP, 14px-24px |

### レスポンシブブレイクポイント
| サイズ | デバイス | 画面幅 | レイアウト |
|-------|---------|-------|---------|
| XS | スマートフォン | < 576px | 1カラム |
| SM | タブレット(縦) | 576-768px | 1-2カラム |
| MD | タブレット(横) | 768-992px | 2カラム |
| LG | PC | 992-1200px | 2-3カラム |
| XL | 大画面PC | ≥ 1200px | 3カラム |

### 共通UI要素
| 要素 | 用途 | スタイル |
|------|------|---------|
| プライマリボタン | 主要アクション | 青背景, 白文字 |
| セカンダリボタン | 補助アクション | グレー背景, 黒文字 |
| 危険ボタン | 削除等 | 赤背景, 白文字 |
| 成功メッセージ | 処理成功 | 緑背景, 3秒後自動消去 |
| エラーメッセージ | 処理失敗 | 赤背景, 手動で閉じる |

---

## 2. 画面一覧

| 画面ID | 画面名 | URL | 権限 | 関連API |
|-------|-------|-----|------|--------|
| S001 | ログイン画面 | /login | 全員 | POST /api/v1/auth/login |
| S002 | ダッシュボード | /dashboard | ログイン済み | GET /api/v1/dashboard/stats |
| S003 | ユーザー一覧 | /users | admin | GET /api/v1/users |
| S004 | ユーザー詳細 | /users/{id} | admin, self | GET /api/v1/users/{id} |
| S005 | ユーザー作成 | /users/new | admin | POST /api/v1/users |
| S006 | ユーザー編集 | /users/{id}/edit | admin, self | PUT /api/v1/users/{id} |
| S007 | 注文一覧 | /orders | all | GET /api/v1/orders |
| S008 | 注文詳細 | /orders/{id} | all | GET /api/v1/orders/{id} |
| S009 | 注文作成 | /orders/new | all | POST /api/v1/orders |
| S010 | 商品一覧 | /products | all | GET /api/v1/products |
| S011 | 商品詳細 | /products/{id} | all | GET /api/v1/products/{id} |

---

## 3. 画面詳細設計

### 3.1 S001: ログイン画面

**基本情報**
- URL: `/login`
- 権限: 全員 (未ログイン)
- 関連API: `POST /api/v1/auth/login`

**レイアウト**
```
┌────────────────────────────┐
│      [ロゴ]                 │
│                             │
│      ログイン                │
│                             │
│  メールアドレス               │
│  [__________入力欄__________]│
│                             │
│  パスワード                  │
│  [__________入力欄__________]│ [👁表示切替]
│                             │
│  [✓] ログイン状態を保持       │
│                             │
│  [    ログイン    ]  ボタン   │
│                             │
│  パスワードを忘れた方はこちら  │
│  アカウント登録はこちら        │
└────────────────────────────┘
```

**項目定義**
| ID | 項目名 | 種類 | 初期値 | 必須 | 最大長 | バリデーション |
|----|-------|------|-------|------|-------|--------------|
| email | メールアドレス | text | - | ○ | 255 | メール形式 |
| password | パスワード | password | - | ○ | 100 | 最小8文字 |
| rememberMe | ログイン保持 | checkbox | false | × | - | - |

**バリデーション**
| 項目 | タイミング | エラーメッセージ |
|------|----------|----------------|
| email (未入力) | 送信時 | 「メールアドレスを入力してください」 |
| email (形式) | フォーカス外れ時 | 「メールアドレスの形式が正しくありません」 |
| password (未入力) | 送信時 | 「パスワードを入力してください」 |
| 認証失敗 | API応答時 | 「メールアドレスまたはパスワードが正しくありません」 |

**処理フロー**
1. ユーザーがメールアドレス・パスワード入力
2. 「ログイン」ボタンクリック → クライアント側バリデーション
3. API呼び出し `POST /api/v1/auth/login`
4. 成功: トークンをlocalStorageに保存 → ダッシュボードへ遷移
5. 失敗: エラーメッセージ表示

**画面遷移**
- ログイン成功 → S002 ダッシュボード
- 「パスワードを忘れた」 → パスワードリセット画面
- 「アカウント登録」 → 新規登録画面

---

### 3.2 S002: ダッシュボード

**基本情報**
- URL: `/dashboard`
- 権限: ログイン済み
- 関連API: `GET /api/v1/dashboard/stats`

**レイアウト**
```
┌──────────────────────────────────────────────┐
│ [ロゴ] ダッシュボード ユーザー管理 設定 [👤▼] │ ← ヘッダー
├──────────────────────────────────────────────┤
│ ようこそ、{ユーザー名}さん                       │
│                                               │
│ ┌─────────┐ ┌─────────┐ ┌─────────┐         │
│ │ユーザー数 │ │注文数    │ │売上      │         │
│ │ 1,234   │ │ 5,678   │ │¥1,234,567│         │
│ │(+12)    │ │(+56)    │ │(+¥12,345)│         │
│ └─────────┘ └─────────┘ └─────────┘         │
│                                               │
│ ■ 最近の注文                                   │
│ ┌───────────────────────────────────┐        │
│ │No│注文日│顧客名│金額│ステータス      │        │
│ ├───────────────────────────────────┤        │
│ │001│01/01│山田│¥10,000│完了         │        │
│ │002│01/01│佐藤│¥ 5,000│処理中       │        │
│ └───────────────────────────────────┘        │
│ [もっと見る]                                   │
└──────────────────────────────────────────────┘
```

**取得データ**
- API: `GET /api/v1/dashboard/stats`
- レスポンス:
  ```json
  {
    "userCount": 1234,
    "userCountChange": 12,
    "orderCount": 5678,
    "orderCountChange": 56,
    "totalSales": 1234567,
    "totalSalesChange": 12345,
    "recentOrders": [...]
  }
  ```

**処理フロー**
1. 画面初期表示時にAPI呼び出し
2. ローディング表示
3. データ取得成功 → 統計情報・最近の注文を表示
4. データ取得失敗 → エラーメッセージ表示

---

### 3.3 S003: ユーザー一覧

**基本情報**
- URL: `/users`
- 権限: admin
- 関連API: `GET /api/v1/users`

**レイアウト**
```
┌──────────────────────────────────────────────┐
│ ユーザー管理                    [+ 新規作成]   │
├──────────────────────────────────────────────┤
│ 検索: [____________] ロール:[▼] ステータス:[▼]│
├──────────────────────────────────────────────┤
│ ID│メール│名前│ロール│ステータス│アクション    │
├──────────────────────────────────────────────┤
│ 1 │user1@...│山田│admin│active │[詳細][編集] │
│ 2 │user2@...│佐藤│user │active │[詳細][編集] │
│ 3 │user3@...│田中│user │inactive│[詳細][編集] │
├──────────────────────────────────────────────┤
│ 1-20 / 全100件    [<] [1] [2] [3] [4] [5] [>]│
└──────────────────────────────────────────────┘
```

**フィルタ・ソート項目**
| 項目 | 種類 | 初期値 | オプション |
|------|------|-------|-----------|
| search | テキスト | - | 名前・メール部分一致 |
| role | セレクト | all | all, admin, user |
| status | セレクト | all | all, active, inactive, suspended |
| sort | セレクト | created_at | id, email, created_at |
| order | セレクト | desc | asc, desc |
| page | 数値 | 1 | - |
| limit | セレクト | 20 | 10, 20, 50, 100 |

**処理フロー**
1. 画面初期表示 → `GET /api/v1/users?page=1&limit=20`
2. フィルタ変更 → APIパラメータ更新して再取得
3. ページネーションクリック → page変更して再取得
4. 「新規作成」ボタン → S005 ユーザー作成画面へ遷移
5. 「詳細」ボタン → S004 ユーザー詳細画面へ遷移
6. 「編集」ボタン → S006 ユーザー編集画面へ遷移

---

### 3.4 S004: ユーザー詳細

**基本情報**
- URL: `/users/{id}`
- 権限: admin, self
- 関連API: `GET /api/v1/users/{id}`

**レイアウト**
```
┌──────────────────────────────────────────────┐
│ ユーザー詳細              [編集] [削除] [戻る]│
├──────────────────────────────────────────────┤
│ ID: 1                                         │
│ メールアドレス: user@example.com               │
│ 氏名: 山田太郎                                 │
│ ロール: admin                                 │
│ ステータス: active                             │
│ 最終ログイン: 2024-01-01 12:00:00              │
│ 作成日時: 2023-01-01 00:00:00                 │
│ 更新日時: 2024-01-01 12:00:00                 │
├──────────────────────────────────────────────┤
│ ■ 注文履歴                                     │
│ [注文一覧へのリンク]                           │
└──────────────────────────────────────────────┘
```

**処理フロー**
1. 画面初期表示 → `GET /api/v1/users/{id}`
2. データ表示
3. 「編集」ボタン → S006 ユーザー編集画面へ遷移
4. 「削除」ボタン → 確認ダイアログ表示 → `DELETE /api/v1/users/{id}` → 一覧へ戻る
5. 「戻る」ボタン → S003 ユーザー一覧へ戻る

**エラーハンドリング**
- 404 (ユーザー未存在): 「ユーザーが見つかりません」→ 一覧へ戻る
- 403 (権限不足): 「アクセス権限がありません」→ ダッシュボードへ戻る

---

### 3.5 S005: ユーザー作成

**基本情報**
- URL: `/users/new`
- 権限: admin
- 関連API: `POST /api/v1/users`

**レイアウト**
```
┌──────────────────────────────────────────────┐
│ ユーザー作成                      [戻る]       │
├──────────────────────────────────────────────┤
│ メールアドレス *                               │
│ [_______________________入力欄____________]   │
│                                               │
│ パスワード *                                  │
│ [_______________________入力欄____________]   │
│                                               │
│ 氏名 *                                        │
│ [_______________________入力欄____________]   │
│                                               │
│ ロール                                        │
│ [▼ user                      ]               │
│                                               │
│            [キャンセル]  [作成]                │
└──────────────────────────────────────────────┘
```

**項目定義**
| ID | 項目名 | 種類 | 初期値 | 必須 | 最大長 | バリデーション |
|----|-------|------|-------|------|-------|--------------|
| email | メールアドレス | text | - | ○ | 255 | メール形式, 一意 |
| password | パスワード | password | - | ○ | 100 | 最小8文字, 英数字記号含む |
| name | 氏名 | text | - | ○ | 100 | 1-100文字 |
| role | ロール | select | user | × | - | admin, user |

**バリデーション**
| 項目 | タイミング | エラーメッセージ |
|------|----------|----------------|
| email (未入力) | 送信時 | 「メールアドレスを入力してください」 |
| email (形式) | フォーカス外れ時 | 「メールアドレスの形式が正しくありません」 |
| email (重複) | API応答時 | 「このメールアドレスは既に登録されています」 |
| password (未入力) | 送信時 | 「パスワードを入力してください」 |
| password (長さ) | フォーカス外れ時 | 「パスワードは8文字以上で入力してください」 |
| name (未入力) | 送信時 | 「氏名を入力してください」 |

**処理フロー**
1. 「作成」ボタンクリック → クライアント側バリデーション
2. API呼び出し `POST /api/v1/users`
3. 成功: 成功メッセージ表示 → S004 ユーザー詳細画面へ遷移 (作成したユーザー)
4. 失敗: エラーメッセージ表示
5. 「キャンセル」→ S003 ユーザー一覧へ戻る

---

### 3.6 S006: ユーザー編集

**基本情報**
- URL: `/users/{id}/edit`
- 権限: admin, self
- 関連API: `GET /api/v1/users/{id}`, `PUT /api/v1/users/{id}`

**レイアウト** (S005と同様、初期値に既存データをセット)

**項目定義**
| ID | 項目名 | 種類 | 必須 | 最大長 | バリデーション |
|----|-------|------|------|-------|--------------|
| name | 氏名 | text | ○ | 100 | 1-100文字 |
| status | ステータス | select | × | - | active, inactive, suspended (adminのみ) |

**処理フロー**
1. 画面初期表示 → `GET /api/v1/users/{id}` → フォームに既存データをセット
2. 「更新」ボタンクリック → クライアント側バリデーション
3. API呼び出し `PUT /api/v1/users/{id}`
4. 成功: 成功メッセージ表示 → S004 ユーザー詳細画面へ遷移
5. 失敗: エラーメッセージ表示
6. 「キャンセル」→ S004 ユーザー詳細へ戻る

---

### 3.7 S007: 注文一覧

**基本情報**
- URL: `/orders`
- 権限: all (admin: 全注文, user: 自分の注文のみ)
- 関連API: `GET /api/v1/orders`

**レイアウト**
```
┌──────────────────────────────────────────────┐
│ 注文一覧                      [+ 新規注文]     │
├──────────────────────────────────────────────┤
│ ステータス:[▼all] 並び順:[▼注文日▼降順]       │
├──────────────────────────────────────────────┤
│ 注文番号│注文日│金額│ステータス│アクション     │
├──────────────────────────────────────────────┤
│ ORD-001│01/01│¥10,000│配送完了│[詳細]       │
│ ORD-002│01/02│¥ 5,000│処理中 │[詳細]       │
├──────────────────────────────────────────────┤
│ ページネーション                               │
└──────────────────────────────────────────────┘
```

**フィルタ・ソート**
| 項目 | 種類 | 初期値 | オプション |
|------|------|-------|-----------|
| status | セレクト | all | all, pending, confirmed, shipped, delivered, cancelled |
| sort | セレクト | order_date | id, order_date, total_amount |
| order | セレクト | desc | asc, desc |

**処理フロー**
1. 画面初期表示 → `GET /api/v1/orders?page=1&limit=20`
2. フィルタ変更 → APIパラメータ更新して再取得
3. 「詳細」ボタン → S008 注文詳細画面へ遷移
4. 「新規注文」ボタン → S009 注文作成画面へ遷移

---

### 3.8 S008: 注文詳細

**基本情報**
- URL: `/orders/{id}`
- 権限: all (admin: 全注文, user: 自分の注文のみ)
- 関連API: `GET /api/v1/orders/{id}`

**レイアウト**
```
┌──────────────────────────────────────────────┐
│ 注文詳細                            [戻る]     │
├──────────────────────────────────────────────┤
│ 注文番号: ORD-20240101-0001                   │
│ 注文日: 2024-01-01                            │
│ ステータス: 配送完了                           │
│                                               │
│ ■ 注文明細                                     │
│ 商品名│数量│単価│金額                          │
│ 商品A│ 2│¥1,000│¥2,000                      │
│ 商品B│ 1│¥3,000│¥3,000                      │
│                    合計: ¥5,000              │
│                                               │
│ 作成日時: 2024-01-01 10:00:00                 │
│ 更新日時: 2024-01-05 15:00:00                 │
└──────────────────────────────────────────────┘
```

**処理フロー**
1. 画面初期表示 → `GET /api/v1/orders/{id}`
2. データ表示 (注文ヘッダー + 注文明細)
3. 「戻る」ボタン → S007 注文一覧へ戻る

---

### 3.9 S009: 注文作成

**基本情報**
- URL: `/orders/new`
- 権限: all
- 関連API: `GET /api/v1/products`, `POST /api/v1/orders`

**レイアウト**
```
┌──────────────────────────────────────────────┐
│ 新規注文                            [戻る]     │
├──────────────────────────────────────────────┤
│ ■ 商品選択                                     │
│ 商品:[▼選択してください] 数量:[__] [追加]      │
│                                               │
│ ■ 注文明細                                     │
│ 商品名│数量│単価│金額│[削除]                   │
│ 商品A│ 2│¥1,000│¥2,000│ [×]                │
│                                               │
│ 合計金額: ¥2,000                              │
│                                               │
│            [キャンセル]  [注文確定]            │
└──────────────────────────────────────────────┘
```

**項目定義**
| ID | 項目名 | 種類 | 必須 | バリデーション |
|----|-------|------|------|--------------|
| productId | 商品 | select | ○ | 存在する商品ID |
| quantity | 数量 | number | ○ | >= 1 |
| items | 明細リスト | array | ○ | 最小1件 |

**処理フロー**
1. 画面初期表示 → `GET /api/v1/products` → 商品セレクトボックスに表示
2. 商品選択 + 数量入力 + 「追加」ボタン → 明細リストに追加
3. 「削除」ボタン → 該当明細を削除
4. 「注文確定」ボタン → API呼び出し `POST /api/v1/orders`
5. 成功: 成功メッセージ表示 → S008 注文詳細画面へ遷移 (作成した注文)
6. 失敗: エラーメッセージ表示 (在庫不足等)
7. 「キャンセル」→ S007 注文一覧へ戻る

---

### 3.10 S010: 商品一覧

**基本情報**
- URL: `/products`
- 権限: all
- 関連API: `GET /api/v1/products`

**レイアウト** (カード形式またはグリッド表示)
```
┌──────────────────────────────────────────────┐
│ 商品一覧                                       │
│ 検索: [____________] ステータス:[▼active]     │
├──────────────────────────────────────────────┤
│ ┌─────────┐ ┌─────────┐ ┌─────────┐        │
│ │[画像]    │ │[画像]    │ │[画像]    │        │
│ │商品A     │ │商品B     │ │商品C     │        │
│ │¥1,000   │ │¥2,000   │ │¥3,000   │        │
│ │在庫: 100 │ │在庫: 50  │ │在庫: 30  │        │
│ │[詳細]    │ │[詳細]    │ │[詳細]    │        │
│ └─────────┘ └─────────┘ └─────────┘        │
└──────────────────────────────────────────────┘
```

**処理フロー**
1. 画面初期表示 → `GET /api/v1/products?status=active`
2. 検索・フィルタ変更 → APIパラメータ更新して再取得
3. 「詳細」ボタン → S011 商品詳細画面へ遷移

---

### 3.11 S011: 商品詳細

**基本情報**
- URL: `/products/{id}`
- 権限: all
- 関連API: `GET /api/v1/products/{id}`

**レイアウト**
```
┌──────────────────────────────────────────────┐
│ 商品詳細                            [戻る]     │
├──────────────────────────────────────────────┤
│ [商品画像]                                     │
│                                               │
│ 商品名: 商品A                                  │
│ 価格: ¥1,000                                  │
│ 在庫: 100個                                   │
│ ステータス: 販売中                             │
│                                               │
│ ■ 商品説明                                     │
│ 商品Aの詳細説明がここに表示されます。           │
│                                               │
│              [カートに追加]                     │
└──────────────────────────────────────────────┘
```

**処理フロー**
1. 画面初期表示 → `GET /api/v1/products/{id}`
2. データ表示
3. 「カートに追加」ボタン → S009 注文作成画面へ遷移 (商品を事前選択)
4. 「戻る」ボタン → S010 商品一覧へ戻る

---

## 4. 共通コンポーネント

### ヘッダー
- ロゴ (左上、クリックでダッシュボードへ)
- ナビゲーション (主要メニュー)
- ユーザーメニュー (右上、ドロップダウンでプロフィール・ログアウト)

### フッター
- コピーライト: © 2024 Company Name
- リンク: プライバシーポリシー、利用規約

### ローディング表示
- 全画面: スピナー + 「読み込み中...」
- ボタン内: ボタン内にスピナー表示

### ページネーション
- ページ番号: 1, 2, 3, ...
- 前へ/次へボタン
- 件数表示: 「1-20 / 全100件」

---

## 5. 重要な設計判断

### フォームバリデーション
- クライアント側: リアルタイムバリデーション (フォーカス外れ時)
- サーバー側: API応答エラーをフィールド単位で表示

### エラーハンドリング
- 401 (認証エラー): 自動的にログイン画面へリダイレクト
- 403 (権限エラー): ダッシュボードへリダイレクト + エラーメッセージ
- 404 (未存在): 一覧画面へリダイレクト + エラーメッセージ
- 500 (サーバーエラー): エラーメッセージ表示 + requestId表示

### レスポンシブ対応
- PC: 3カラムレイアウト
- タブレット: 2カラムレイアウト
- スマートフォン: 1カラム + ハンバーガーメニュー

### アクセシビリティ
- キーボード操作: Tab, Enter, Escapeで操作可能
- ARIA属性: スクリーンリーダー対応
- カラーコントラスト: WCAG AA基準 (4.5:1以上)
