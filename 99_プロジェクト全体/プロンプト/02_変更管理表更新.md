# 変更管理表 更新プロンプト

## 目的

プロジェクト開始後に発生する仕様変更・追加要望をNotionの変更管理DBに登録し、影響範囲(QCD: 品質・コスト・納期)を分析して、適切な承認プロセスを管理する。

---

## インプット

以下のいずれか、または組み合わせ:

1. **変更申請の内容**
   - 変更内容の説明
   - 変更理由
   - 申請者情報
   - 希望対応時期

2. **会議議事録**
   - 顧客からの追加要望
   - 仕様変更の提案
   - 外部要因による変更

3. **既存の変更ID** (更新の場合)
   - 承認/却下の判定結果
   - 対応完了報告

4. **要件定義書、設計書** (影響分析に使用)
   - `02_要件定義/テンプレート/01_要件定義書.md`
   - `02_要件定義/テンプレート/08_WBS.md`
   - `03_開発工程/テンプレート/` 配下の設計書

---

## 出力指示

### モード1: 新規変更申請登録

Notion変更管理DBに新規エントリを作成し、影響分析を実施する。

#### 必須項目の自動生成

1. **変更ID**: `CR-{連番3桁}` (例: CR-001, CR-002)
   - 既存の最大番号+1で自動採番

2. **申請日**: 実行日 (YYYY/MM/DD)

3. **申請者**:
   - ユーザー入力
   - 議事録から判定 (顧客名、または開発チーム)

4. **変更内容**: ユーザー入力または議事録から抽出
   - 簡潔で具体的な変更内容

5. **変更理由**: ユーザー入力または議事録から抽出
   - なぜこの変更が必要か (ビジネス要求、法令対応、不具合修正など)

6. **優先度**: 以下のルールで判定
   - **高**: プロジェクト成功に必須、法令対応、セキュリティ対応など
     - キーワード例: 「必須」「法令」「セキュリティ」「重大な問題」
   - **中**: 業務効率に影響、ユーザビリティ向上など
     - キーワード例: 「効率化」「使いやすさ」「改善」
   - **低**: あると便利だが必須ではない改善要望
     - キーワード例: 「できれば」「あると嬉しい」「検討してほしい」

7. **影響範囲**: 変更内容から以下を判定 (複数選択可)
   - **要件**: 要件定義書の修正が必要
   - **設計**: 基本設計・詳細設計の修正が必要
   - **実装**: ソースコードの修正が必要
   - **テスト**: テストケースの追加・修正が必要
   - **スケジュール**: 納期への影響あり
   - **コスト**: 追加費用が発生
   - **品質**: 品質リスクへの影響あり

8. **工数影響**: 変更内容から見積もり (時間単位)
   - 要件定義書、WBS、設計書を参照して類似タスクから推定
   - 不明な場合は "要見積もり" と記載

9. **コスト影響**: 工数影響から計算 (万円単位)
   - 計算式: `工数(h) × 単価(円/h) ÷ 10,000`
   - デフォルト単価: 5,000円/h (調整可能)

10. **スケジュール影響**: 工数影響とクリティカルパス分析から算出 (日単位)
    - 並行作業可能な場合: 工数影響 ÷ 8h ÷ 稼働人数
    - クリティカルパス上の場合: 工数影響 ÷ 8h (1人日換算)

11. **ステータス**: 新規登録時は "申請中"

12. **承認者**: 影響レベルに応じて推奨担当者を提示
    - 軽微 (工数8h未満、コスト5万円未満) → PM単独
    - 中程度 (工数8〜40h、コスト5〜20万円) → PM + 顧客担当者
    - 重大 (工数40h超、コスト20万円超) → PM + 顧客担当者 + 営業 + 経営層

---

### モード2: 影響分析実施

変更内容を詳細に分析し、影響範囲とリスクを明確化する。

#### 分析手順

1. **要件定義書との照合**
   - 変更が既存の要件定義にどう影響するか
   - 関連する機能一覧、ユースケースを特定

2. **設計書との照合**
   - DB設計、API設計、画面設計への影響
   - 関連するテーブル、API、画面を特定

3. **WBSとの照合**
   - 影響を受けるタスクを特定
   - クリティカルパス上のタスクかを確認

4. **工数見積もり**
   - 要件修正: X時間
   - 設計修正: X時間
   - 実装: X時間
   - テスト: X時間
   - 合計: X時間

5. **リスク評価**
   - 変更による品質リスク
   - 納期への影響
   - 既存機能への影響

#### 影響分析の出力例

```
【変更影響分析】CR-XXX

■ 変更内容
ログイン画面にパスワード強度チェック機能を追加

■ 影響範囲
- 要件: 要件定義書 §3.2 ログイン機能の修正が必要
- 設計: 画面設計書「ログイン画面」の修正が必要
- 実装: ログイン画面コンポーネント、バリデーション処理の追加
- テスト: ログイン機能のテストケース追加

■ 工数見積もり
- 要件修正: 1h
- 設計修正: 1h
- 実装: 4h (フロントエンド3h + バックエンド1h)
- テスト: 2h
- 合計: 8h (1人日)

■ コスト影響
8h × 5,000円/h = 40,000円 (4万円)

■ スケジュール影響
+2日 (実装1日 + テスト1日)

■ リスク評価
- 品質リスク: 低 (既存機能への影響なし)
- 納期リスク: 低 (バッファ期間内で対応可能)
- 技術リスク: 低 (標準的な実装)

■ 推奨承認レベル
軽微 (PM単独で承認可)
```

---

### モード3: 承認判定登録

承認者が承認/却下/保留を判断した結果を記録する。

#### 更新項目

1. **承認者**: 承認を行った担当者
2. **承認日**: 判定日 (YYYY/MM/DD)
3. **ステータス**:
   - "承認済み": 変更を実施する
   - "却下": 変更を実施しない
   - "保留": 後日再検討
4. **対応予定日**: 承認された場合の対応完了予定日
5. **備考**: 判定理由、条件など

---

### モード4: 対応完了登録

承認された変更が実装完了したことを記録する。

#### 更新項目

1. **完了日**: 対応完了日 (YYYY/MM/DD)
2. **ステータス**: "対応中" → "完了"
3. **備考**: 実装結果、特記事項

---

## 作成ガイドライン

### 1. 変更申請の抽出 (議事録から)

#### Step 1: 変更要望の識別

議事録の中から以下のパターンを探す:

- 「〜を追加してほしい」
- 「〜に変更できないか」
- 「〜の仕様を見直したい」
- 「追加要望」「変更希望」とマークされた項目
- 「次フェーズで」と記載されているが、今対応すべき項目

#### Step 2: 変更内容の整形

```
【元の発言】
「ログイン画面なんですけど、パスワードのチェック機能みたいなのって追加できます?
最近セキュリティポリシーが変わって、強度チェックが必要になっちゃって...」

【整形後】
変更内容: ログイン画面にパスワード強度チェック追加
変更理由: セキュリティポリシー変更
```

### 2. Notion MCPでの操作手順

#### 新規変更申請登録

```javascript
// Notion MCP の create_page ツールを使用
{
  "parent": { "database_id": "{変更管理DB ID}" },
  "properties": {
    "変更ID": { "title": [{ "text": { "content": "CR-001" } }] },
    "申請日": { "date": { "start": "2025-01-15" } },
    "申請者": { "rich_text": [{ "text": { "content": "顧客A" } }] },
    "変更内容": { "rich_text": [{ "text": { "content": "ログイン画面にパスワード強度チェック追加" } }] },
    "変更理由": { "rich_text": [{ "text": { "content": "セキュリティポリシー変更" } }] },
    "優先度": { "select": { "name": "高" } },
    "影響範囲": { "multi_select": [{ "name": "要件" }, { "name": "設計" }, { "name": "実装" }, { "name": "テスト" }] },
    "工数影響": { "number": 8 },
    "コスト影響": { "number": 4 },
    "スケジュール影響": { "number": 2 },
    "ステータス": { "status": { "name": "申請中" } },
    "プロジェクト": { "relation": [{ "id": "{プロジェクトページID}" }] }
  }
}
```

#### 承認判定登録

```javascript
// Notion MCP の update_page ツールを使用
{
  "page_id": "{変更ページID}",
  "properties": {
    "承認者": { "rich_text": [{ "text": { "content": "PM田中" } }] },
    "承認日": { "date": { "start": "2025-01-16" } },
    "ステータス": { "status": { "name": "承認済み" } },
    "対応予定日": { "date": { "start": "2025-01-25" } },
    "備考": { "rich_text": [{ "text": { "content": "スケジュール内で対応可能と判断" } }] }
  }
}
```

---

## チェックリスト

### 新規変更申請登録時

- [ ] 変更IDが一意になっているか
- [ ] 変更内容が具体的で明確か
- [ ] 変更理由が記載されているか
- [ ] 優先度が妥当か
- [ ] 影響範囲が漏れなく分析されているか
- [ ] 工数見積もりが過去の類似変更と整合しているか
- [ ] コスト影響が工数から正しく計算されているか
- [ ] スケジュール影響がクリティカルパスを考慮しているか
- [ ] 推奨承認レベルが影響度に応じて適切か

### 影響分析実施時

- [ ] 要件定義書との照合が完了しているか
- [ ] 設計書との照合が完了しているか
- [ ] WBSとの照合が完了しているか
- [ ] リスク評価が実施されているか
- [ ] 影響分析結果が備考欄に記載されているか

### 承認判定登録時

- [ ] 承認者が記録されているか
- [ ] 承認/却下/保留の理由が明確か
- [ ] 承認済みの場合、対応予定日が設定されているか
- [ ] 却下の場合、代替案や次フェーズ対応が検討されているか

---

## 使用例

### 例1: 変更申請を登録

**インプット (議事録)**

```
顧客Aより追加要望:
「データエクスポート機能なんですけど、CSV形式だけじゃなくてExcelでも出せるようにしてほしいんです。
上司がExcelしか使えなくて...」
```

**出力 (Notion登録内容)**

```
CR-002: データエクスポート形式にExcelを追加
- 申請日: 2025/01/20
- 申請者: 顧客A
- 変更理由: 顧客要望 (上司がExcel形式を希望)
- 優先度: 中
- 影響範囲: 実装、テスト
- 工数影響: 12h
- コスト影響: 6万円
- スケジュール影響: +3日
- ステータス: 申請中
- 推奨承認レベル: 中程度 (PM + 顧客担当者の合意が必要)
```

### 例2: 影響分析を実施

**インプット**

```
変更ID: CR-002
変更内容: データエクスポート形式にExcelを追加
要件定義書: {要件定義書の内容}
設計書: {API設計書の内容}
```

**出力 (影響分析)**

```
【変更影響分析】CR-002

■ 影響範囲詳細
- 要件: 要件定義書 §4.5 データエクスポート機能の修正不要 (CSV/Excel両対応と記載済み)
- 設計: API設計書「/api/export」にExcel出力ロジック追加
- 実装: エクスポート処理にExcelライブラリ追加、フォーマット変換処理実装
- テスト: エクスポート機能のテストケース追加 (Excel形式)

■ 工数見積もり
- ライブラリ調査・選定: 2h
- 実装 (バックエンド): 8h
- テスト: 2h
- 合計: 12h (1.5人日)

■ コスト影響
12h × 5,000円/h = 60,000円 (6万円)

■ スケジュール影響
+3日 (実装2日 + テスト1日)
※ 並行作業可能な範囲のため、クリティカルパスへの影響は軽微

■ リスク評価
- 品質リスク: 低 (既存CSV出力と同様のロジック)
- 納期リスク: 中 (バッファ期間内だが余裕は少ない)
- 技術リスク: 低 (Excel出力ライブラリは実績あり)

■ 推奨対応
スケジュールに余裕があれば対応推奨。
余裕がない場合は次フェーズまたは運用回避策 (CSV→Excelの手動変換手順書提供) を検討。
```

---

## サマリー表示機能

変更管理表の現状をサマリー表示する。

### 表示項目

1. **ステータス別件数**

```
【変更管理サマリー】
- 申請中: 2件
- 承認待ち: 1件
- 承認済み: 3件
- 却下: 1件
- 対応中: 2件
- 完了: 4件
合計: 13件
```

2. **累積影響 (承認済み + 対応中)**

```
【累積影響】
- 承認済み変更件数: 3件
- 対応中変更件数: 2件
- 累積工数影響: 48時間 (6人日)
- 累積コスト影響: 24万円
- 最大スケジュール影響: +5日
```

3. **承認待ちアラート**

```
【⚠️ 承認待ち】
- CR-005: 帳票レイアウト変更 (申請日: 2025/01/18、5日経過)
  影響: 工数16h、コスト8万円、スケジュール+4日
  推奨承認レベル: 中程度 (PM + 顧客担当者)
```

---

## 関連ドキュメント

- [Notion DB構造設計](../Notion_DB構造設計.md)
- [変更管理表テンプレート](../変更管理表.md)
- [要件定義書](../../02_要件定義/テンプレート/01_要件定義書.md)
- [WBS](../../02_要件定義/テンプレート/08_WBS.md)

---

**作成日:** 2025/10/26
**最終更新日:** 2025/10/26
