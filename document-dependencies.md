# ドキュメント依存関係マップ

このドキュメントは、AI駆動型プロジェクト管理における各種ドキュメント間の依存関係と整合性確認ポイントを定義します。

## 凡例

- **📄 ドキュメント**: 成果物
- **⬅️ INPUT**: インプットとなる前フェーズのドキュメント
- **➡️ OUTPUT**: アウトプット先の後フェーズのドキュメント
- **🔗 参照項目**: 具体的な整合性チェックポイント

---

## フェーズ1: 要求分析・ヒアリング

### 📄 プロジェクト計画書

**作成タイミング**: ヒアリング完了後（週4回×4週間）

**⬅️ INPUT**
- 議事録（週次ヒアリング）
- As-Is業務フロー
- ペインポイント整理表
- 既存システム構成メモ

**➡️ OUTPUT**
- 要件定義書
- 見積書
- WBS

**🔗 整合性チェックポイント**
- プロジェクト計画書の「背景」「目的」← 議事録の要点抽出プロンプトで抽出された課題
- プロジェクト計画書の「スコープ」← As-Is業務フローの対象範囲
- プロジェクト計画書の「KPI」← ペインポイント整理で特定された優先課題（S/A評価）
- プロジェクト計画書の「成果物一覧」→ 要件定義書・見積書・WBSの納期と整合

**参照セクション**
- プロジェクト計画書: §1.3 プロジェクトの背景, §2.1 プロジェクトの目的
- プロジェクト計画書: §4.1 主要成果物一覧

---

### 📄 業務記述書（As-Is / To-Be）

**作成タイミング**: ヒアリング第2-3週

**⬅️ INPUT**
- 議事録（現行業務フロー・課題）
- ペインポイント整理表

**➡️ OUTPUT**
- 要件定義書（機能一覧）
- プロジェクト計画書
- 業務フロー図（UML）

**🔗 整合性チェックポイント**
- As-Is業務記述書の「プロセス詳細」← 議事録から抽出した現行業務フロー
- As-Is業務記述書の「ファイル・データ一覧」→ 要件定義書の「データ・移行要件」
- To-Be業務記述書の改善点 ← ペインポイント整理表の優先課題（S/A）
- To-Be業務記述書の「プロセス詳細」→ 機能一覧の機能ID（機能として実現される業務プロセス）

**参照セクション**
- 業務記述書: §2. プロセス詳細, §3. ファイル・データ一覧

---

## フェーズ2: 要件定義

### 📄 要件定義書

**作成タイミング**: 要件定義フェーズ完了時

**⬅️ INPUT**
- プロジェクト計画書
- To-Be業務記述書
- 機能一覧
- ユースケース
- 画面遷移
- 非機能要件チェックリスト
- 既存データ整理
- 外部IF一覧

**➡️ OUTPUT**
- 見積書
- WBS
- 詳細設計書（DB設計、画面設計、API設計）

**🔗 整合性チェックポイント**
- 要件定義書 §1「プロジェクト概要」← プロジェクト計画書 §1-2（背景・目的・スコープ）
- 要件定義書 §3.1「機能一覧」← To-Be業務記述書の「プロセス番号（P-XXX）」とマッピング
- 要件定義書 §3.1「機能一覧」→ 見積書 §3「見積明細（機能別）」の機能ID
- 要件定義書 §3.2「ユースケース・画面マッピング」← ユースケーステンプレート、画面遷移テンプレート
- 要件定義書 §4「非機能要件」← 非機能要件テンプレート
- 要件定義書 §5「データ・移行要件」← 既存データ整理テンプレート
- 要件定義書 §6「外部システム連携要件」← 外部IF一覧テンプレート
- 要件定義書 §7「UI／画面サマリー」← 画面遷移テンプレート
- 要件定義書 §8.1「要求〜要件対応表」← プロジェクト計画書のペインポイント → 機能要件へのトレーサビリティ
- 要件定義書 §10「受入基準」→ 受入基準書の合格基準

**参照セクション**
- 要件定義書: §3.1 機能一覧, §5.1 主要データ一覧, §6 外部システム連携要件, §8.1 要求〜要件対応表

---

### 📄 機能一覧

**作成タイミング**: 要件定義初期

**⬅️ INPUT**
- To-Be業務記述書

**➡️ OUTPUT**
- 要件定義書
- 見積書
- WBS

**🔗 整合性チェックポイント**
- 機能一覧の「機能ID」← To-Be業務記述書の「プロセス番号（P-XXX）」
- 機能一覧の「優先度（必須/推奨/任意）」→ 要件定義書 §3.1「機能一覧」の優先度
- 機能一覧の「機能ID」→ 見積書の「機能ID」（工数・金額算定の基礎）

**参照セクション**
- 機能一覧: §3. 機能一覧テーブル

---

### 📄 見積書

**作成タイミング**: 要件定義完了後

**⬅️ INPUT**
- 要件定義書
- 機能一覧
- WBS

**➡️ OUTPUT**
- プロジェクト計画書（ROI分析）

**🔗 整合性チェックポイント**
- 見積書 §3.1「機能別見積一覧」← 要件定義書 §3.1「機能一覧」の機能ID
- 見積書 §3.1「画面数・バッチ数・API数」← 要件定義書 §7「UI／画面サマリー」
- 見積書 §4「工程×機能」の工数 → WBS §2「WBS詳細」の工数
- 見積書 §3.1「複雑度（低/中/高）」→ WBS §2「WBS詳細」のタスク分割粒度
- 見積書 §1.2「工数サマリー」= WBS §1.2「フェーズ別サマリー」の総工数
- 見積書 §7「リスクと対応」→ プロジェクト計画書 §12「リスク管理」

**参照セクション**
- 見積書: §3.1 機能別見積一覧, §4 見積明細（工程×機能）

---

### 📄 WBS

**作成タイミング**: 要件定義完了後

**⬅️ INPUT**
- 要件定義書
- 機能一覧
- 見積書

**➡️ OUTPUT**
- プロジェクト計画書（マイルストーン）
- 進捗報告書

**🔗 整合性チェックポイント**
- WBS §2「WBS詳細」← 見積書 §4「工程×機能」の作業項目
- WBS §2.1-2.13「各フェーズのタスク」← 要件定義書 §3.1「機能一覧」の機能ID
- WBS §3「マイルストーン」→ プロジェクト計画書 §6.2「重要マイルストーン（ゲート）」
- WBS §4「クリティカルパス」→ プロジェクト計画書 §6.1「プロジェクトスケジュール」
- WBS §2「成果物」→ プロジェクト計画書 §4.1「主要成果物一覧」
- WBS §1.2「フェーズ別サマリー」の工数 = 見積書 §1.2「工数サマリー」

**参照セクション**
- WBS: §2. WBS詳細, §3. マイルストーン, §4. クリティカルパス

---

## フェーズ3: 詳細設計・開発準備

### 📄 DB設計書

**作成タイミング**: 基本設計フェーズ

**⬅️ INPUT**
- 要件定義書（データ・移行要件）
- 機能一覧
- 既存データ整理

**➡️ OUTPUT**
- API設計書
- 画面設計書
- テストケース

**🔗 整合性チェックポイント**
- DB設計書 §3「テーブル定義」← 要件定義書 §5.1「主要データ一覧」
- DB設計書 §3「テーブル定義」のテーブル名 ← 既存データ整理テンプレートのデータ名
- DB設計書 §3「カラム定義」→ API設計書のリクエスト/レスポンス項目
- DB設計書 §3「外部キー」→ 要件定義書 §6「外部システム連携要件」のデータ連携
- DB設計書 §6「データ保持ポリシー」← 要件定義書 §5.1「保持期間」

**参照セクション**
- DB設計書: §3. テーブル定義

---

### 📄 画面設計書

**作成タイミング**: 基本設計フェーズ

**⬅️ INPUT**
- 要件定義書（UI／画面サマリー）
- 画面遷移テンプレート
- ユースケーステンプレート

**➡️ OUTPUT**
- API設計書
- テストケース

**🔗 整合性チェックポイント**
- 画面設計書 §2「画面一覧」← 要件定義書 §7「UI／画面サマリー」の画面ID
- 画面設計書 §3「画面詳細設計」の「関連API」→ API設計書のエンドポイント
- 画面設計書 §3「画面遷移」← 画面遷移テンプレートの遷移定義
- 画面設計書 §3「項目定義」→ DB設計書のカラム定義
- 画面設計書 §3「バリデーション」→ テストケースの境界値テスト

**参照セクション**
- 画面設計書: §2. 画面一覧, §3. 画面詳細設計

---

### 📄 API設計書

**作成タイミング**: 基本設計フェーズ

**⬅️ INPUT**
- 要件定義書（機能一覧、外部IF一覧）
- 画面設計書
- DB設計書

**➡️ OUTPUT**
- テストケース
- システム構成図

**🔗 整合性チェックポイント**
- API設計書のエンドポイント ← 画面設計書 §3「関連API」
- API設計書のリクエスト/レスポンス項目 ← DB設計書 §3「カラム定義」
- API設計書の外部API連携 ← 要件定義書 §6「外部システム連携要件」（IF-ID）
- API設計書のエンドポイント → テストケースのAPI呼び出しテスト
- API設計書のエンドポイント → システム構成図のコンポーネント間通信

**参照セクション**
- （API設計書テンプレートの詳細はテンプレートファイルを参照）

---

### 📄 システム構成図

**作成タイミング**: 基本設計フェーズ

**⬅️ INPUT**
- 要件定義書（非機能要件）
- 既存システム構成整理

**➡️ OUTPUT**
- 運用設計書

**🔗 整合性チェックポイント**
- システム構成図 ← 要件定義書 §4「非機能要件」（性能・可用性・セキュリティ）
- システム構成図のインフラ構成 ← 既存システム構成整理テンプレート
- システム構成図 → 運用設計書の監視・バックアップ対象

**参照セクション**
- （システム構成図テンプレートの詳細はテンプレートファイルを参照）

---

## フェーズ4: テスト

### 📄 テストケース

**作成タイミング**: 結合テスト前

**⬅️ INPUT**
- 要件定義書（機能一覧）
- 画面設計書
- API設計書
- DB設計書

**➡️ OUTPUT**
- テスト結果報告書
- 受入基準書

**🔗 整合性チェックポイント**
- テストケース「機能：XXX」← 要件定義書 §3.1「機能一覧」の機能ID
- テストケース「テストデータ」← DB設計書 §3「カラム定義」のバリデーション
- テストケース「境界値」← 画面設計書 §3「項目定義」の最大長・最小値
- テストケース「異常系」← API設計書のエラーレスポンス定義
- テストケース「テスト観点」→ 受入基準書 §1.1「機能要件の充足」

**参照セクション**
- テストケース: §テストケース一覧

---

### 📄 受入基準書

**作成タイミング**: 受入テスト前

**⬅️ INPUT**
- 要件定義書（受入基準）
- テストケース
- プロジェクト計画書

**➡️ OUTPUT**
- 検収完了書

**🔗 整合性チェックポイント**
- 受入基準書 §1.1「機能要件」← 要件定義書 §3.1「機能一覧」の全機能ID
- 受入基準書 §1.1「合格基準」← テストケースの優先度別合格率
- 受入基準書 §1.2「非機能要件」← 要件定義書 §4「非機能要件」の目標値
- 受入基準書 §1.3「成果物の納品」← プロジェクト計画書 §4.1「主要成果物一覧」
- 受入基準書 §1.5「データ移行」← 要件定義書 §5.2「移行ステップ」

**参照セクション**
- 受入基準書: §1. 受入基準, §2. 検収手順

---

## フェーズ5: 進捗管理（全フェーズ横断）

### 📄 進捗報告書

**作成タイミング**: 週次・月次

**⬅️ INPUT**
- WBS
- プロジェクト計画書
- リスク管理台帳

**➡️ OUTPUT**
- プロジェクト完了報告書

**🔗 整合性チェックポイント**
- 進捗報告書「進捗率」← WBS §2「進捗率」の集計
- 進捗報告書「マイルストーン達成状況」← WBS §3「マイルストーン」の実績日
- 進捗報告書「予算消化率」← 見積書 §1.1「見積サマリー」
- 進捗報告書「リスク」← プロジェクト計画書 §12「リスク管理」
- 進捗報告書「課題」← プロジェクト計画書 §13「課題管理」

**参照セクション**
- 進捗報告書: （進捗報告書テンプレートの詳細はテンプレートファイルを参照）

---

## 整合性チェックマトリクス

以下は、主要なドキュメント間の整合性チェックポイントをマトリクス形式で表現したものです。

| FROM ＼ TO | プロジェクト<br>計画書 | 業務記述書<br>(As-Is/To-Be) | 要件定義書 | 機能一覧 | 見積書 | WBS | DB設計 | 画面設計 | API設計 | テストケース | 受入基準書 |
|----------|------------|-------------------|---------|--------|-------|-----|-------|---------|--------|------------|-----------|
| **議事録** | 背景・目的 | プロセス詳細 | - | - | - | - | - | - | - | - | - |
| **プロジェクト計画書** | - | スコープ | 概要 | - | ROI分析 | マイルストーン | - | - | - | - | 成果物 |
| **業務記述書(To-Be)** | - | - | 機能要件 | 機能ID | - | - | - | - | - | - | - |
| **要件定義書** | - | - | - | 機能一覧 | 機能ID | タスク | データ要件 | 画面ID | IF要件 | 機能ID | 機能要件 |
| **機能一覧** | - | - | 機能一覧 | - | 機能ID | タスク | - | - | - | テスト対象 | - |
| **見積書** | ROI分析 | - | - | - | - | 工数 | - | - | - | - | - |
| **WBS** | マイルストーン | - | - | - | 工数 | - | - | - | - | - | - |
| **DB設計** | - | - | - | - | - | - | - | 項目定義 | リクエスト/レスポンス | テストデータ | - |
| **画面設計** | - | - | 画面ID | - | - | - | 項目定義 | - | 関連API | バリデーション | - |
| **API設計** | - | - | IF要件 | - | - | - | カラム | 関連API | - | API呼び出し | - |
| **テストケース** | - | - | - | - | - | - | - | - | - | - | 合格基準 |

---

## bpr-doc-reviewer エージェントでの活用

このドキュメント依存関係マップは、`.claude/agents/bpr-doc-reviewer.md` エージェントが以下のチェックを実行する際の基礎情報となります：

### 1. トレーサビリティチェック
- 要求（ペインポイント）→ 要件（機能一覧）→ 設計（DB/画面/API）→ テスト の一貫性

### 2. データ整合性チェック
- 機能ID、画面ID、テーブル名、API エンドポイント名の統一
- 件数・工数・金額の整合（見積書 ⇔ WBS）

### 3. 網羅性チェック
- 要件定義書の全機能 → 見積書の全機能ID
- 機能一覧の全機能 → テストケースの全テスト対象
- 要件定義書のデータ要件 → DB設計の全テーブル

### 4. フェーズゲート通過基準チェック
- 要件定義完了ゲート：要件定義書・見積書・WBS の整合性
- 設計完了ゲート：DB設計・画面設計・API設計 と 要件定義書の整合性
- テスト完了ゲート：テストケース と 受入基準書の整合性

---

## 更新履歴

| 版数 | 更新日 | 更新者 | 更新内容 |
|-----|--------|--------|---------|
| v1.0 | 2025/10/26 | Claude | 初版作成 |
