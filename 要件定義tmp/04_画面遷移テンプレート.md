# 画面遷移図・IF定義書

## ドキュメント管理情報

| 項目 | 内容 |
|------|------|
| プロジェクト名 | |
| ドキュメント名 | 画面遷移図・IF定義書 |
| 作成日 | YYYY/MM/DD |
| 最終更新日 | YYYY/MM/DD |
| 版数 | v1.0 |
| 作成者 | |
| 承認者 | |

---

## 1. 画面遷移図

### 1.1 全体画面遷移図

```
[画面遷移図をここに配置]

ログイン (SC-000)
    ↓
ホーム (SC-001)
    ├→ {メニュー1} (SC-010)
    │   ├→ {サブ画面1-1} (SC-011)
    │   └→ {サブ画面1-2} (SC-012)
    ├→ {メニュー2} (SC-020)
    │   └→ {サブ画面2-1} (SC-021)
    └→ 設定 (SC-900)
```

### 1.2 画面分類とサマリー

| 画面カテゴリ | 画面数 | 画面ID範囲 | 備考 |
|------------|--------|----------|------|
| 認証・ログイン | X画面 | SC-000～SC-009 | |
| ホーム・ダッシュボード | X画面 | SC-001～SC-009 | |
| {業務機能1} | X画面 | SC-010～SC-019 | |
| {業務機能2} | X画面 | SC-020～SC-029 | |
| マスタ管理 | X画面 | SC-800～SC-899 | |
| システム設定 | X画面 | SC-900～SC-999 | |
| **合計** | XX画面 | - | |

---

## 2. 画面一覧

### 2.1 画面一覧表

| 画面ID | 画面名 | 画面種別 | 機能ID | UC-ID | アクセス権限 | 優先度 | 備考 |
|--------|-------|---------|--------|-------|------------|--------|------|
| SC-000 | ログイン | 認証 | F-001 | UC-001 | 全ユーザー | 必須 | |
| SC-001 | ホーム | ダッシュボード | F-002 | UC-002 | ログインユーザー | 必須 | |
| SC-010 | {画面名} | 一覧 | F-010 | UC-010 | 一般/管理者 | 必須 | |
| SC-011 | {画面名}詳細 | 詳細 | F-011 | UC-011 | 一般/管理者 | 必須 | |
| SC-012 | {画面名}登録 | 入力 | F-012 | UC-012 | 管理者のみ | 必須 | |

**画面種別:**
- 一覧: データ一覧表示
- 詳細: データ詳細表示
- 入力: データ新規登録・編集
- 検索: 検索条件入力
- ダッシュボード: 複数情報の集約表示
- 認証: ログイン・認証関連

---

## 3. 画面詳細定義

### SC-000: ログイン画面

#### 3.1.1 基本情報

| 項目 | 内容 |
|------|------|
| 画面ID | SC-000 |
| 画面名 | ログイン |
| 画面種別 | 認証 |
| URL/パス | /login |
| 関連機能 | F-001: ログイン機能 |
| 関連UC | UC-001: ユーザーログイン |
| アクセス権限 | すべてのユーザー（未認証） |

#### 3.1.2 画面概要

ユーザーがシステムにログインするための認証画面

#### 3.1.3 画面レイアウト

```
+----------------------------------+
|         {システム名}              |
+----------------------------------+
|                                  |
|   ユーザーID: [_____________]    |
|                                  |
|   パスワード: [_____________]    |
|                                  |
|   ☐ ログイン状態を保持する       |
|                                  |
|         [ログイン]                |
|                                  |
|   パスワードを忘れた方はこちら    |
+----------------------------------+
```

#### 3.1.4 画面項目定義

| 項目ID | 項目名 | 種別 | 必須 | 桁数 | 形式 | 初期値 | バリデーション | 備考 |
|--------|--------|------|------|------|------|--------|---------------|------|
| FLD-001 | ユーザーID | テキスト | ○ | 20 | 半角英数 | - | 必須、半角英数のみ | |
| FLD-002 | パスワード | パスワード | ○ | 20 | 半角英数記号 | - | 必須、8文字以上 | マスク表示 |
| FLD-003 | ログイン状態を保持 | チェックボックス | - | - | true/false | false | - | |

#### 3.1.5 操作・ボタン定義

| ボタンID | ボタン名 | 機能ID | 処理内容 | 遷移先 | 備考 |
|---------|---------|--------|---------|--------|------|
| BTN-001 | ログイン | F-001 | 認証処理を実行 | SC-001（成功時）<br>SC-000（失敗時） | |
| LNK-001 | パスワードを忘れた方 | F-005 | パスワードリセット処理 | SC-005 | |

#### 3.1.6 画面遷移

**遷移元:**
- 直接アクセス（URL直接入力）
- すべての画面（ログアウト時）
- セッションタイムアウト時

**遷移先:**
- SC-001: ホーム画面（ログイン成功時）
- SC-005: パスワードリセット画面（パスワード忘れリンククリック時）

```
                  ┌──────────┐
                  │ SC-000   │
                  │ ログイン │
                  └──────────┘
                       │
         ┌─────────────┼─────────────┐
         │             │             │
    [成功]         [失敗]      [リンク]
         │             │             │
         ↓             ↓             ↓
   ┌──────────┐  ┌──────────┐  ┌──────────┐
   │ SC-001   │  │ SC-000   │  │ SC-005   │
   │ ホーム   │  │エラー表示│  │パスワード│
   └──────────┘  └──────────┘  │リセット  │
                                └──────────┘
```

#### 3.1.7 バリデーション

**入力チェック:**

| チェック項目 | チェック内容 | エラーメッセージ | タイミング |
|------------|------------|----------------|-----------|
| 必須チェック | ユーザーID未入力 | 「ユーザーIDを入力してください」 | ログインボタン押下時 |
| 必須チェック | パスワード未入力 | 「パスワードを入力してください」 | ログインボタン押下時 |
| 形式チェック | ユーザーID形式 | 「ユーザーIDは半角英数字で入力してください」 | ログインボタン押下時 |
| 認証チェック | 認証失敗 | 「ユーザーIDまたはパスワードが正しくありません」 | 認証処理時 |
| アカウントロック | ログイン失敗5回 | 「アカウントがロックされました。管理者に連絡してください」 | 認証処理時 |

#### 3.1.8 イベント・処理

**画面表示時:**
1. セッションをクリア
2. ログイン画面を表示

**ログインボタン押下時:**
1. 入力値をバリデーション
2. 認証処理を実行
3. 成功時: ホーム画面へ遷移
4. 失敗時: エラーメッセージ表示、失敗回数をカウント

#### 3.1.9 セキュリティ要件

- パスワードはマスク表示
- 通信はHTTPS必須
- ログイン失敗回数を記録
- 5回失敗でアカウントロック
- セッション有効期限: 30分

#### 3.1.10 非機能要件

| 項目 | 要件 |
|------|------|
| レスポンスタイム | 認証処理: 2秒以内 |
| 可用性 | 24時間365日利用可能 |
| セキュリティ | HTTPS通信、アカウントロック機能 |
| ブラウザ対応 | Chrome, Firefox, Edge, Safari最新版 |

#### 3.1.11 実装上の注意事項

- ログイン状態保持はCookieで管理（有効期限7日間）
- CSRF対策トークンを実装
- SQLインジェクション対策を実施

---

### SC-001: ホーム画面

#### 3.2.1 基本情報

| 項目 | 内容 |
|------|------|
| 画面ID | SC-001 |
| 画面名 | ホーム |
| 画面種別 | ダッシュボード |
| URL/パス | /home |
| 関連機能 | F-002: ダッシュボード表示 |
| 関連UC | UC-002: ホーム画面表示 |
| アクセス権限 | ログイン済みユーザー |

#### 3.2.2 画面概要

ログイン後の初期画面。ユーザーの業務に応じた情報を集約表示

#### 3.2.3 画面レイアウト

```
+--------------------------------------------------+
| {システム名}  ユーザー名: XXX  [ログアウト]      |
+--------------------------------------------------+
| メニュー                                          |
| ├ {メニュー1}                                    |
| ├ {メニュー2}                                    |
| └ 設定                                           |
+--------------------------------------------------+
|                                                  |
| お知らせ                        新着タスク        |
| ┌──────────────┐        ┌──────────────┐  |
| │ ・XXXX        │        │ ・タスク1     │  |
| │ ・YYYY        │        │ ・タスク2     │  |
| └──────────────┘        └──────────────┘  |
|                                                  |
| 統計情報                                          |
| ┌──────────────────────────────────────┐  |
| │ グラフ・チャート                           │  |
| └──────────────────────────────────────┘  |
|                                                  |
+--------------------------------------------------+
```

#### 3.2.4 画面項目定義

| エリアID | エリア名 | 表示内容 | データ取得元 | 更新頻度 |
|---------|---------|---------|------------|---------|
| AREA-001 | お知らせ | 最新のお知らせ5件 | お知らせテーブル | リアルタイム |
| AREA-002 | 新着タスク | 未完了タスク10件 | タスクテーブル | リアルタイム |
| AREA-003 | 統計情報 | 各種統計グラフ | 集計テーブル | 日次更新 |

<!-- 以下同様に他の画面も記述 -->

---

## 4. 画面遷移パターン

### 4.1 基本遷移パターン

#### パターン1: 一覧→詳細→編集

```
SC-010 (一覧)
    ↓ [詳細ボタン]
SC-011 (詳細)
    ↓ [編集ボタン]
SC-012 (編集)
    ↓ [保存]
SC-011 (詳細)
```

#### パターン2: 検索→一覧→詳細

```
SC-015 (検索)
    ↓ [検索実行]
SC-010 (一覧)
    ↓ [詳細ボタン]
SC-011 (詳細)
```

#### パターン3: モーダルダイアログ

```
SC-010 (一覧)
    ↓ [削除ボタン]
MOD-001 (確認ダイアログ)
    ↓ [OK]
SC-010 (一覧・更新)
```

---

## 5. 外部インターフェース（IF）定義

### 5.1 IF一覧

| IF-ID | IF名 | IF種別 | 連携先 | 連携方式 | プロトコル | 頻度 | 備考 |
|-------|------|-------|--------|---------|----------|------|------|
| IF-001 | | 送信/受信 | {外部システム名} | API/ファイル/DB | REST/SOAP/FTP/SFTP/JDBC | リアルタイム/バッチ | |
| IF-002 | | | | | | | |

---

### 5.2 IF詳細: IF-001

#### 5.2.1 基本情報

| 項目 | 内容 |
|------|------|
| IF-ID | IF-001 |
| IF名 | {インターフェース名} |
| IF種別 | 送信 / 受信 / 双方向 |
| 連携先システム | {外部システム名} |
| 連携方式 | API連携 / ファイル連携 / DB連携 |
| プロトコル | REST API / SOAP / FTP / SFTP / JDBC |
| 認証方式 | Bearer Token / API Key / Basic認証 / OAuth2 |
| 連携タイミング | リアルタイム / 日次XX:XX / 週次 / 月次 |
| 対応する業務プロセス | P-XXX: {プロセス名}（To-Be業務フロー図より） |

#### 5.2.2 API連携の場合

**エンドポイント:** `https://api.example.com/v1/resource`

**HTTPメソッド:** GET / POST / PUT / DELETE

**リクエストヘッダー:**
```json
{
  "Content-Type": "application/json",
  "Authorization": "Bearer {token}",
  "X-API-Key": "{api_key}"
}
```

**リクエストパラメータ:**
| パラメータ名 | 種別 | データ型 | 必須 | 説明 | 例 |
|------------|------|---------|------|------|-----|
| | Path/Query/Body | string/number/boolean/array/object | ○/- | | |

**リクエストボディ（JSON）:**
```json
{
  "field1": "value1",
  "field2": 123,
  "field3": {
    "nested": "value"
  }
}
```

**レスポンス（成功時 200 OK）:**
```json
{
  "status": "success",
  "data": {
    "id": "12345",
    "field1": "value1"
  }
}
```

**レスポンス（エラー時）:**
| HTTPステータス | エラーコード | メッセージ | 対応方法 |
|--------------|------------|-----------|---------|
| 400 | BAD_REQUEST | Invalid parameter | パラメータ修正 |
| 401 | UNAUTHORIZED | Authentication failed | 認証情報確認 |
| 500 | INTERNAL_ERROR | Server error | リトライ（最大3回） |

**性能要件:**
- レスポンスタイム: X秒以内
- スループット: XX req/sec
- タイムアウト: XX秒

**エラー処理:**
| エラーパターン | 対応方法 | リトライ | 通知先 |
|--------------|----------|---------|--------|
| タイムアウト | リトライ | 3回（間隔5秒） | 管理者 |
| 認証エラー | エラーログ記録、処理中断 | なし | 管理者 |
| サーバーエラー | リトライ | 3回（間隔10秒） | 管理者 |

#### 5.2.3 ファイル連携の場合

**ファイル形式:** CSV / TSV / Fixed Length / XML / JSON / Excel

**ファイル名規則:**
- 送信: `{prefix}_{YYYYMMDD}_{HHMMSS}.{ext}`
- 受信: `{prefix}_*.{ext}`

**ファイル配置:**
- 送信元フォルダ: `/data/outbound/`
- 送信先フォルダ: `/remote/inbound/`
- 受信元フォルダ: `/remote/outbound/`
- 受信先フォルダ: `/data/inbound/`

**ファイルフォーマット（CSV例）:**

**ヘッダー:** あり / なし

**文字コード:** UTF-8 / Shift-JIS / EUC-JP

**改行コード:** LF / CR+LF

**区切り文字:** カンマ / タブ / パイプ

**項目定義:**
| 項目No | 項目名 | データ型 | 桁数 | 必須 | 形式 | 備考 |
|--------|--------|---------|------|------|------|------|
| 1 | | 文字列/数値/日付 | | ○/- | | |
| 2 | | | | | | |

**サンプルデータ:**
```csv
ID,NAME,DATE,AMOUNT
00001,商品A,2025-01-01,1000
00002,商品B,2025-01-02,2000
```

**バリデーション:**
| チェック項目 | チェック内容 | エラー時の対応 |
|------------|------------|--------------|
| ファイル存在チェック | ファイルが存在するか | エラーログ、管理者通知 |
| ヘッダーチェック | ヘッダー項目が正しいか | ファイル拒否、エラー通知 |
| 必須チェック | 必須項目が入力されているか | エラー行をスキップ、エラーログ |
| 形式チェック | データ形式が正しいか | エラー行をスキップ、エラーログ |

**処理フロー:**
1. ファイルの存在確認
2. ファイルのダウンロード/アップロード
3. バリデーション実行
4. データ取り込み/出力
5. 処理結果ファイル生成（成功/エラー件数）
6. 完了通知

**エラー処理:**
- エラー発生時はエラーログファイルを生成
- エラーログファイル名: `{prefix}_{YYYYMMDD}_{HHMMSS}_error.log`
- 管理者にメール通知

**性能要件:**
- 処理件数（想定）: XX,XXX件/回
- 処理時間目標: XX分以内

#### 5.2.4 DB連携の場合

**接続情報:**
- 接続先DB: {DB種別}（Oracle/MySQL/PostgreSQL/SQL Server）
- ホスト: {hostname}:{port}
- データベース名: {database}
- スキーマ: {schema}
- 認証方式: ユーザー名/パスワード

**連携方式:** 直接SELECT/INSERT / ストアドプロシージャ / トリガー

**連携テーブル:**
| テーブル名 | 操作 | 処理内容 | 備考 |
|-----------|------|---------|------|
| {table_name} | SELECT/INSERT/UPDATE/DELETE | | |

**SQL例:**
```sql
SELECT
    column1,
    column2,
    column3
FROM
    schema.table_name
WHERE
    condition = 'value'
    AND date >= CURRENT_DATE - 7
ORDER BY
    column1
```

**トランザクション制御:**
- コミットタイミング: 全件処理後 / N件毎
- ロールバック条件: エラー発生時

---

## 6. モーダル・ダイアログ定義

### 6.1 モーダル一覧

| モーダルID | モーダル名 | 種別 | 呼び出し元 | 用途 | 備考 |
|-----------|-----------|------|-----------|------|------|
| MOD-001 | 削除確認 | 確認 | 各一覧画面 | データ削除前の確認 | |
| MOD-002 | エラー表示 | 警告 | 全画面 | エラーメッセージ表示 | |
| MOD-003 | 詳細ポップアップ | 情報 | SC-010 | 簡易詳細表示 | |

### 6.2 モーダル詳細: MOD-001

**モーダルID:** MOD-001

**モーダル名:** 削除確認ダイアログ

**レイアウト:**
```
+----------------------------------+
|  削除確認                         |
+----------------------------------+
|                                  |
|  選択したデータを削除しますか?    |
|                                  |
|  [キャンセル]  [削除]            |
+----------------------------------+
```

**ボタン:**
- キャンセル: モーダルを閉じる（処理中断）
- 削除: 削除処理を実行、呼び出し元画面を更新

---

## 7. 共通UI要素

### 7.1 ヘッダー

**表示要素:**
- システムロゴ
- ユーザー名
- お知らせアイコン（未読件数バッジ）
- ログアウトボタン

### 7.2 サイドメニュー

**メニュー構成:**
- ホーム
- {業務メニュー1}
  - {サブメニュー1-1}
  - {サブメニュー1-2}
- {業務メニュー2}
- 設定

### 7.3 フッター

**表示要素:**
- コピーライト
- プライバシーポリシー
- 利用規約

### 7.4 ページネーション

**表示形式:**
```
<< < 1 2 3 4 5 > >>
表示件数: [10件▼] [20件] [50件] [100件]
```

---

## 8. レスポンシブデザイン

### 8.1 対応デバイス

| デバイス | 画面幅 | 対応内容 |
|---------|-------|---------|
| PC | 1024px以上 | フルレイアウト |
| タブレット | 768px～1023px | レイアウト調整 |
| スマートフォン | 767px以下 | モバイル最適化 |

### 8.2 レスポンシブ対応画面

| 画面ID | 画面名 | 対応レベル | 備考 |
|--------|-------|-----------|------|
| SC-000 | ログイン | 完全対応 | |
| SC-001 | ホーム | 完全対応 | |
| SC-010 | {画面名} | 部分対応 | 一覧のみ |

---

## 9. アクセシビリティ

### 9.1 アクセシビリティ要件

- WCAG 2.1 レベルAA準拠
- キーボード操作対応
- スクリーンリーダー対応
- コントラスト比 4.5:1以上

### 9.2 対応項目

| 項目 | 対応内容 |
|------|---------|
| 代替テキスト | 全画像にalt属性設定 |
| フォーカス表示 | フォーカス時にアウトライン表示 |
| フォームラベル | 全入力項目にlabel設定 |
| エラー表示 | 色だけでなくアイコンやテキストで表現 |

---

## 10. 関連ドキュメント

| ドキュメント名 | 参照箇所 | 備考 |
|---------------|---------|------|
| 要件定義書 | 全体 | 親ドキュメント |
| 機能一覧 | 関連機能ID | 関連資料 |
| ユースケース定義書 | 関連UC-ID | 関連資料 |
| 非機能要件定義書 | 性能・セキュリティ要件 | 関連資料 |

---

## 改訂履歴

| 版数 | 改訂日 | 改訂者 | 改訂内容 |
|------|--------|--------|----------|
| v0.1 | YYYY/MM/DD | | 初版作成 |
| v1.0 | YYYY/MM/DD | | 正式版 |
| | | | |
